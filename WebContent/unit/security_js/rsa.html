<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="content-type" />
	<meta name="Author" content="" />
	<meta name="Keywords" content="" />
	<meta name="Description" content="" />
	<meta Http-Equiv="Content-Language" content="zh-cn" />
	<title>RSA加解密测试</title>
	<script type="text/javascript" src="jsbn.js"></script>
	<script type="text/javascript" src="prng4.js"></script>
	<script type="text/javascript" src="rng.js"></script>
	<script type="text/javascript" src="rsa.js"></script>
</head>
<body>

<script type="text/javascript">

function doRSAEncrypt(key,input){	
	if(key == '') return input;	
	
	var rsa = new RSAKey();
	rsa.setPublic(key, "10001");
	var res = rsa.encrypt(input);
	
	if(res == null) return input;
	return res;
}

function en(){
	var start = new Date().getTime();
	var key = document.getElementById("RSAPublicKey").value;
	var input = document.getElementById("idNo").value;	
	var raw = doRSAEncrypt(key,input);
	document.getElementById("firstEncrypt").value = raw;
}

</script>
	<textarea type='text' name="firstEncrypt" id="firstEncrypt" style='width:400px;height:150px' value=""></textarea><br/>	
	公钥，请根据实际值替换：<input type='text' name="RSAPublicKey" id="RSAPublicKey" style='width:400px' value="dd6be3d4de56287b8c3616b33bc1b7a5a2bb9148252140262420ee047f83b3165fb7674a759d60c24b71fd5437c7810f127f2c4370c2d4bdfcb55c08f1b3c715b7b2f57228e78e34039d2b967f54a58e345bc91e3dd54c7bea86d73c9e2de968736bf2b97f50bea891aa3519ae7238d76dff57cabba7cc0d370775657f3b5c83" />
	<form method="post" name="loginForm" target="_blank">
		<table border="0">
			<tr>
				<td colspan="2" align="center">
					<input type='text' name="idNo" id="idNo" style='width:400px' value="测试ABCabc123"/>
				</td>
			</tr>	
			<tr>
				<td>
					<input type="button" value="加密" onclick="en();" />
				</td>
			</tr>
		</table>
	</form>
</body>
</html>